"use strict";var app=angular.module("eliteApp",["ui.router"]);app.config(function(e,o,t){o.otherwise("/"),e.state("welcome",{url:"/",templateUrl:"./public/html/welcome.html",controller:"WelcomeCtrl"}).state("return",{url:"/return",templateUrl:"./public/html/return.html",controller:"ReturnCtrl"}).state("search",{parent:"return",templateUrl:"./public/html/search.html",controller:"SearchCtrl"}).state("finder",{parent:"return",templateUrl:"./public/html/searchPanel.html",controller:"FinderCtrl"}).state("control",{parent:"return",templateUrl:"./public/html/controlPanel.html",controller:"ControlCtrl"}).state("history",{parent:"return",templateUrl:"./public/html/history.html",controller:"HistoryCtrl"}).state("favorite",{parent:"return",templateUrl:"./public/html/favorite.html",controller:"FavoriteCtrl"})}),app.controller("ControlCtrl",["$scope","$state","$timeout",function(e,o,t){console.log("Control Controller loaded!"),e.secondPhase=!1,e.showSecondPhase=function(){e.secondPhase=!0},t(e.showSecondPhase,2e3),e.searchBar=function(){e.secondPhase=!1,o.go("finder")},e.viewHistory=function(){e.secondPhase=!1,o.go("history")},e.viewFavorites=function(){e.secondPhase=!1,o.go("favorite")}}]),app.controller("FavoriteCtrl",["$scope","$state",function(e,o){console.log("Favorite Controller loaded"),e.savedSpots=localStorage.savedSpots?JSON.parse(localStorage.savedSpots):[],console.log(e.savedSpots),e["return"]=function(){o.go("control")}}]),app.controller("FinderCtrl",["$scope","$state","$timeout",function(e,o,t){e.thirdPhase=!1,e.showThirdPhase=function(){e.thirdPhase=!0},t(e.showThirdPhase,300),console.log("SEARCH CONTROLLER"),e.searchData=function(){mixpanel.track("Location searched"),console.log("FINDER?"),o.go("search")}}]),app.controller("HistoryCtrl",["$scope","$state",function(e,o){console.log("History Controller loaded!"),e["return"]=function(){o.go("control")}}]),app.controller("InitCtrl",["$scope","$timeout","$state",function(e,o,t){mixpanel.track("Home Page Visited")}]),app.controller("NavionicsCtrl",["$scope","$http",function(e,o){console.log("NAVIONICS WORKS!!!")}]),app.controller("ReturnCtrl",["$scope","$http","$timeout","$state",function(e,o,t,r){r.go("control"),e.firstVisit=JSON.parse(localStorage.firstVisit),localStorage.visited||r.go("welcome"),e.firstVisit===!0&&(localStorage.firstVisit=JSON.stringify(!1)),e.firstPhase=!1,e.fullName=JSON.parse(localStorage.fullName),e.showFirstPhase=function(){console.log("TIMEOUT?"),e.firstPhase=!0},t(e.showFirstPhase,1e3)}]),app.controller("SearchCtrl",["$scope","$http","$state",function(e,o,t){$(function(){$('[data-toggle="tooltip"]').tooltip()}),console.log("Search controller loaded!"),e.day,e.temp,e.pressure,e.condition,e.grade,e.technique=["Deep Water","Top Water","Trolling"][Math.floor(3*Math.random())];e.forecastData=[];var r="http://api.wunderground.com/api/dec8bf3b3a454036/forecast10day/q/CA/Fremont.json",a="http://api.wunderground.com/api/dec8bf3b3a454036/conditions/q/CA/Fremont.json",n="api.openweathermap.org/data/2.5/forecast/daily?q=Fremont&mode=json&units=imperial&cnt=10?APPID=99c2f58822d3d9b37eaaed986d390d29";o.get(n).success(function(e){console.log("OPEN:",e)}),o.get(r).then(function(o){var o=o.data.forecast.simpleforecast.forecastday;e.day=o[0].date.weekday,e.temp=o[0].high.fahrenheit,e.condition=o[0].conditions,e.grade=["B"][0],e.forecastData=o,console.log(e.forecastData),console.log(e.forecastData[0].date)}),o.get(a).then(function(o){var r=o.data.current_observation.pressure_mb;r>1086?e.pressure="Extremely High: "+r:r>1030?e.pressure="High: "+r:r>1013?e.pressure="Average: "+r:r>1e3?e.pressure="Low: "+r:r>980?e.pressure="Very low: "+r:r>950?e.pressure="Severely low: "+r:r>870?e.pressure="EXTREME DANGER!"+r:870>r&&(e.pressure="Tornado warning! "+r),e.displayMore=!1,console.log(e.displayMore),e.expand=function(){console.log("I COMMAND YOU TO EXPAND!"),e.displayMore=!e.displayMore},e["return"]=function(){t.go("control")}}),e.savedSpots=[],e.saveSpot=function(){var o=new Date,t=o.toUTCString();console.log(t),mixpanel.track("Location Saved"),e.savedSpots.push({date:t,temp:e.temp,pressure:e.pressure,condition:e.condition,grade:e.grade,technique:e.technique}),localStorage.savedSpots=JSON.stringify(e.savedSpots)}}]),app.controller("WelcomeCtrl",["$scope","$timeout","$http","radarService","$state",function(e,o,t,r,a){console.log(localStorage),localStorage.visited?a.go("return"):a.go("welcome"),e.firstPhase=!1,e.secondPhase=!1,e.thirdPhase=!1,e.showFirstPhase=function(){e.firstPhase=!0},e.showSecondPhase=function(){e.secondPhase=!0},e.showThirdPhase=function(){e.thirdPhase=!0},o(e.showFirstPhase,1e3),o(e.showSecondPhase,2e3),o(e.showThirdPhase,3e3),e.radarImage=!1;new Waypoint({element:document.getElementById("radarImageTrigger"),handler:function(o){console.log("Radar hit:",o),"down"===o&&(e.radarImage=!0,console.log(e.radarImage),e.$apply())},offset:"80%"});e.depthImage=!1;var n=(new Waypoint({element:document.getElementById("depthImageTrigger"),handler:function(o){console.log("Radar hit:",o),"down"===o&&(e.depthImage=!0,console.log(e.depthImage),e.$apply())},offset:"80%"}),"Guest"),l="Fremont, CA";e.saveInfo=function(){mixpanel.track("User Joined"),localStorage.fullName=JSON.stringify(e.fullName),localStorage.homeLocation=JSON.stringify(e.homeLocation),localStorage.memberSince=JSON.stringify(Date.now()),e.fullName="",e.homeLocation="",localStorage.visited=JSON.stringify(!0),localStorage.firstVisit=JSON.stringify(!0),a.go("return")},e.saveInfoGuest=function(){mixpanel.track("Tried by Guest"),localStorage.fullName=JSON.stringify(n),localStorage.homeLocation=JSON.stringify(l),localStorage.memberSince=JSON.stringify(Date.now()),e.fullName="",e.homeLocation="",localStorage.visited=JSON.stringify(!0),localStorage.firstVisit=JSON.stringify(!0),a.go("return")}}]),app.service("radarService",function(e){var o="http://api.wunderground.com/api/dec8bf3b3a454036/geolookup/q/autoip.json";this.getIP=function(){return e.get(o)}});